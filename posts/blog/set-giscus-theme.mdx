---
title: giscusì— ë‹¤í¬ ëª¨ë“œ ì ìš©í•˜ê¸° (feat. state ëŒ€ì‹  event í™œìš©)
description: state ëŒ€ì‹  eventë¥¼ í™œìš©í•˜ì—¬ ë‹¤í¬ ëª¨ë“œë¥¼ ì ìš©í•´ë³´ì
date: 2023-07-29
tags: [giscus, giscusë‹¤í¬ëª¨ë“œ, next.jsë¸”ë¡œê·¸, storageEvent, dispatchEvent]
imgUrl: set-giscus-theme.jpeg
isPublished: true
---

ë¸”ë¡œê·¸ì— ê¹ƒí—ˆë¸Œ ëŒ“ê¸€ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ë„êµ¬ë¡œ `Utterance`ê°€ ìˆë‹¤. ë‚˜ë„ ì²˜ìŒì—ëŠ” Utteranceë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í–ˆìœ¼ë‚˜, `Giscus`ëŠ” ëŒ€ëŒ“ê¸€ì„ ë‹¬ ìˆ˜ ìˆëŠ” ê²ƒê³¼ `Issues` íƒ­ ëŒ€ì‹  `Discussions`íƒ­ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì´ ëŒë ¤ì„œ Utterance ëŒ€ì‹  Giscusë¥¼ ì‚¬ìš©í–ˆë‹¤.

## ë¬¸ì œì 

Comments ì»´í¬ë„ŒíŠ¸ë¥¼ ë”°ë¡œ ë§Œë“¤ê³  Giscus ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ì ìš©í•˜ë‹ˆ ê¹ƒí—ˆë¸Œ ëŒ“ê¸€ ê¸°ëŠ¥ì„ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ëŸ¬ë‚˜, ì´ˆê¸°ì— localStorageì˜ theme ê°’ì„ ê°€ì ¸ì™€ ì ìš©ì‹œí‚¤ê¸°ëŠ” í–ˆëŠ”ë° ë‹¤í¬ ëª¨ë“œ \<-\> ë¼ì´íŠ¸ ëª¨ë“œ ì „í™˜ ì‹œ giscusì˜ í…Œë§ˆê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì ì´ ë§¤ìš° ê±°ìŠ¬ë ¸ë‹¤.

ì œì¼ ë¨¼ì € ë– ì˜¬ë¦° í•´ê²° ë°©ë²•ì€ ì „ì—­ ìƒíƒœ ì„¤ì •ì´ì—ˆë‹¤. í•˜ì§€ë§Œ ë‚´ ë¸”ë¡œê·¸ì—ì„œëŠ” í…Œë§ˆ ëª¨ë“œ ë³€ê²½ì— stateë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì´ê²ƒ(giscus) í•˜ë‚˜ ë•Œë¬¸ì— ì „ì—­ ìƒíƒœ ì„¤ì •ì„ í•´ì•¼í•œë‹¤ëŠ” ì ì´ ë‚´ê²Œ ë°°ë³´ë‹¤ ë°°ê¼½ì´ ë” í° ìƒí™©ì²˜ëŸ¼ ëŠê»´ì¡Œë‹¬ê¹Œ..?

í…Œë§ˆ ë³€ê²½ ì•„ì´ì½˜ì„ í´ë¦­í–ˆì„ ë•Œ ìœ ì¼í•˜ê²Œ localStorage ê°’ë§Œ ë³€ê²½ë˜ì–´ì„œ ì´ê±¸ ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆì„ê¹Œ ì°¾ì•„ë³´ë‹ˆ window ì´ë²¤íŠ¸ ì¤‘ì— storage ê°’ì´ ë³€ê²½ë  ë•Œ storageë¼ëŠ” ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ëŠ” ê±¸ ì•Œê²Œ ëë‹¤.ğŸ˜Š [(ì°¸ê³  mdn - window storage_event)](https://developer.mozilla.org/en-US/docs/Web/API/Window/storage_event)

## ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€í•˜ê¸°

```ts
// Comments.tsx
useEffect(() => {
  const handleStorageChange = (event: StorageEvent) => {
    console.log(event);
  };
  window.addEventListener('storage', handleStorageChange);
  return () => {
    window.removeEventListener('storage', handleStorageChange);
  };
}, []);
```

ìœ„ì™€ ê°™ì´ ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³  í…Œë§ˆ ë³€ê²½ ë²„íŠ¼ì„ í´ë¦­í–ˆìœ¼ë‚˜ ì½˜ì†”ì— ì•„ë¬´ ê²ƒë„ ì°íˆì§€ ì•Šì•˜ë‹¤. ê°œë°œì ë„êµ¬ íƒ­ì—ì„œ localStorage ê°’ì´ ë³€ê²½ë˜ëŠ” ê±¸ í™•ì¸í–ˆëŠ”ë° handleStorageChange í•¨ìˆ˜ê°€ ì‘ë™í•˜ì§ˆ ì•Šì•˜ë‹¤. ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ì•„ì•¼í•˜ë‚˜ ì‹¶ì—ˆì§€ë§Œ eventë¥¼ ê°•ì œë¡œ ì‹¤í–‰ì‹œì¼œë´¤ë”ë‹ˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ë™ì‘í–ˆê³  ì½˜ì†” ê°’ë„ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.

```ts
// ThemeMode.tsx
const changeTheme = useCallback(() => {
  const currTheme = localStorage.getItem('theme');
  const otherTheme = currTheme === 'light' ? 'dark' : 'light';
  localStorage.setItem('theme', otherTheme);
  document.body.classList.toggle('dark');
  window.dispatchEvent(new StorageEvent('storage', { key: otherTheme })); // ğŸ’¡ ìƒˆë¡œ ì¶”ê°€
}, []);
```

![storage event ì½˜ì†” ì¶œë ¥](../posts/blog/set-giscus-theme/storageevent.jpeg)

ìœ„ event.keyì— í˜„ì¬ í…Œë§ˆ ê°’ì´ ë‹´ê²¨ ìˆë‹¤. ì´ í…Œë§ˆ ê°’ì„ ì•„ë˜ì™€ ê°™ì´ ì ìš©ì‹œí‚¤ë©´ giscusì˜ í…Œë§ˆê°€ í˜„ì¬ í…Œë§ˆì— ë§ê²Œ ë³€ê²½ì´ ì˜ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.ğŸ‰

```ts
// Comments.tsx
const changeGiscusTheme = (theme: string) => {
  const iframe = document.querySelector<HTMLIFrameElement>('iframe.giscus-frame');
  iframe?.contentWindow?.postMessage(
    {
      giscus: {
        setConfig: {
          theme: theme,
        },
      },
    },
    'https://giscus.app',
  );
};
```

![í…Œë§ˆ ë³€ê²½ gif](https://github.com/yunjeoming/yuns-blog/assets/76480300/78567552-7a87-4e62-ad10-41c96bca7545)


### ì°¸ê³ 
[https://github.com/giscus/giscus/issues/336](https://github.com/giscus/giscus/issues/336)
